{% load static %}

<div class="container mt-4">
    <div class="card">
        <div class="row">
        <div class="col-md-8">
            {% if activity.activity_img %}
            <img class="card-img-top select" src="{{ activity.activity_img.url }}" 
            alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/770x560?text=Image not available';" 
            style="object-fit:cover;margin:auto;height:470px;display:inline;border-radius:0;">
            {% else %}
            <img class="card-img-top select" src="http://via.placeholder.com/770x568?text=Image not available" 
            alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:470px;border-radius:0;">
            {% endif %}
        </div>
        <div class="col-md-4">
            <!-- DATE AND TIME -->
            <!--    Activities that only occur once -->
            {% if activity.term == 'Once' %}
            {% if activity.activity_date %}
            <h4 class="card-text mt-4">{{ activity.activity_date|date:'M' }}</h4>
            <h4 class="card-text">{{ activity.activity_date|date:'d' }}</h4>

            <!-- <h4 class="card-text mt-4">{{ activity.activity_date|date:'D, d F Y' }} 
                {{ activity.start_time|time:'g:i A'|lower }} - {{ activity.end_time|time:'g:i A'|lower }}
            </h4> -->
            {% endif %}
            {% endif %}
            <!--      Daily, weekly, fortnightly, monthly activities-->
            {% if activity.term != 'Once' %}
            <h4 class="card-text mt-4">{{ activity.start_date|date:'M' }}</h4>
            <h4 class="card-text">{{ activity.start_date|date:'d' }}</h4>
            <!-- <p class="card-text">Every {{ activity.activity_day }} from {{ activity.start_date|date:'D, d F Y' }} to {{ activity.end_date|date:'D, d F Y' }} 
                {{ activity.start_time|time:'g:i A'|lower }} - {{ activity.end_time|time:'g:i A'|lower }}
            </p> -->
            <!-- <p class="card-text">Every day from {{ activity.start_date|date:'D, d M Y' }} to {{ activity.end_date|date:'D, d F Y' }} 
                {{ activity.start_time|time:'g:i A'|lower }} - {{ activity.end_time|time:'g:i A'|lower }}
            </p> -->
            {% endif %}

            <h4 class="mt-5" style="font-size:28px;color:#666666;">
                {{ activity.name }} - {{ activity.suburb }}
            </h4>

            {% if activity.organiser %}
            <p class="card-text">Organiser - {{ activity.organiser }} {{ activity.contact_number }}</p>
            {% else %}
            <p class="card-text small"><i>Organiser contact hasn't been specified</i></p>
            {% endif %}
    
            {% if activity.cost_choice == 'N' %}
            <h6 class="card-text mt-5">FREE!</h6>
            {% endif %}
            {% if activity.cost_choice == 'Y' %}
            <h6 class="card-text mt-5">AUD {{ activity.cost }}</h6>
            {% endif %}
        </div>
        </div>
    
        <div class="row justify-content-center mt-4">

        {% if activity.created_by == user %}
        <div class="col-sm-2 col-6 justify-content-center mb-4">
            <a href="#collapseExample" data-toggle="collapse" role="button" aria-expanded="false" 
            aria-controls="collapseExample" class="btn" style="color:#484848;margin-left:25px;">
            <img src="{% static 'img/icons/people.svg' %}" height="45">&nbsp;&nbsp;
            <img src="{% static 'img/icons/down-arrow.svg' %}" height="25"></a>
            <div class="collapse" id="collapseExample" style="z-index:1;position:absolute; 
            border:solid #0f0f0fa9 0.5px;background:#FFFFFF;border-radius:1%;padding:20px;">
            <div class="mt-2 mb-2" style="overflow-x:auto;">
                <span id="send-reminder-btn">
                {% include 'booking/includes/send_reminder_btn.html' %}
                </span>
                <table class="table" id="contact-table">
                {% include 'booking/includes/partial_attendee_list.html' %}
                </table>
            </div>
            </div>
        </div>
        {% endif %}

        {% if activity.created_by == user %}
        <div class="col-6 col-sm-2 mb-4">
        {% else %}
        <div class="col-4 mb-4">
        {% endif %}
        <div class="row justify-content-center">
        <a href="#" class="btn js-share-url">
            <img src="{% static 'img/icons/share.svg' %}" height="45"></a>
        <a href="#" class="btn js-share-url" style="color:#484848;margin-top:10px;"></a>
        </div>
        </div>
        
    
        {% if activity.created_by == user %}
        <div class="col-6 col-sm-2 mb-4">
            <div class="row justify-content-center">
            {% if attendees_no > 0 %}
            <img src="{% static 'img/icons/checklist.svg' %}" height="45">
            <a href="{% url 'print_attendee_list' activity.pk %}" class="btn" style="color:#484848;"></a>
            {% else %}
            <img src="{% static 'img/icons/checklist.svg' %}" height="45">
            <a href="#" class="btn disabled" style="color:#484848;"></a>
            {% endif %}
            </div>
        </div>
        {% endif %}

        {% if activity.created_by == user %}
        <div class="col-6 col-sm-2 mb-4">
        {% else %}
        <div class="col-4 mb-4">
        {% endif %}
            <div class="row justify-content-center">
            <img src="{% static 'img/icons/advertising.svg' %}" height="45">
            {% if activity.flyer %}
            <a href="{{ activity.flyer.url }}" class="btn" style="color:#484848;"></a>
            {% endif %}
            {% if not activity.flyer %}
            <a href="#" class="btn disabled" style="color:#484848;"></a>
            {% endif %}
            </div>
        </div>

        <div class="col-12 col-sm-4">
            {% if user.is_authenticated %}
            <button class="btn btn-lg btn-block disabled">Register</button>
            {% else %}
            {% if available %}
            <a href="{% url 'register_activity' activity.pk %}" class="btn btn-success btn-lg btn-block mt-2" style="vertical-align:middle;display: inline-block;">I'M COMING!</a>
            {% else %}
            <button class="btn btn-lg btn-block disabled">Fully booked</button>
            {% endif %}
            {% endif %}
            </div>
        </div>
    </div>
    </div>
    
    <div class="container" style="padding-bottom:80px;">
        <div class = "row">
        <div class="col-md-8">
        <h6 class="bold-text" style="margin-top:2%;margin-bottom:5%;">Description</h6>
        <p class="light-text" style="margin-bottom:5%;">{{ activity.description }}</p>
        <h6 class="bold-text" style="margin-top:10%;margin-bottom:5%;">Eligibility</h6>
        {% if activity.min_age and activity.max_age %}
        <span class="light-text">{{ activity.min_age }} to {{ activity.max_age }} years of age</span><br />
        {% endif %}
    
        {% if activity.max_age and not activity.min_age %}
        <span class="light-text">Maximum: {{ activity.max_age }} years old </span><br />
        {% endif %}
    
        {% if activity.min_age and not activity.max_age %}
        <span class="light-text">Minimum: {{ activity.min_age }} years old </span><br />
        {% endif %}
    
        {% if activity.background %} <span class="light-text">{{ activity.background }}</span><br />{% endif %}
        
        <span class="light-text">
        {% if activity.gender == 'F' %}Only females<br />{% endif %}
        {% if activity.gender == 'M' %}Only males<br />{% endif %}
        </span>
        {% if activity.living_duration != 'Open' %}
        <span class="light-text">Living in Australia for {{ activity.living_duration|lower }} than 5 years </span>      
        {% endif %}
    
        <h6 class="bold-text" style="margin-top:10%;margin-bottom:5%;">Space & Cost</h6>
        <!--      Number of available spaces-->
        {% if activity.space_choice == 'Limited' %}
        <span class="light-text">Available space: <span id="available_space">{{ activity.space }}</span><br /></span>
        {% endif %}

        <p class="light-text mt-4">
            <img src="http://via.placeholder.com/60x50?text=" alt="Not Found" height="50px" width="60px">
            &nbsp;&nbsp;&nbsp;&nbsp;{{ activity.created_by.profile.organisation_name }}</p>
        {% if activity.created_by.profile.description %}
        <p class="light-text">{{ activity.created_by.profile.description }}</p>
        {% else %}
        <p class="light-text">No description about the organiser</p>
        {% endif %}
    
        <p class="card-text">
        {% if user.is_authenticated %}
        {% if activity.created_by == user %}
        {% if activity.published %}
        <a id="edit_btn_url" href="{% url 'edit_activity' activity.pk %}" 
        class="btn btn-lg btn-blue mt-4">Edit Activity</a>
        <a id="edit_btn_url" href="{% url 'delete_activity' activity.pk %}" 
        class="btn btn-danger btn-lg mt-4 ml-2">Delete</a>
        {% else %}
        <a id="edit_btn_url" href="{% url 'edit_draft_activity' activity.pk %}" 
        class="btn btn-lg btn-blue mt-4">Edit Activity</a>
        <a id="edit_btn_url" href="{% url 'submit_activity' activity.pk %}" 
        class="btn btn-green btn-lg mt-4 ml-2">Publish</a>
        {% endif %}
        {% endif %}
        {% else %}
        <a id="edit_btn_url" href="{% url 'edit_activity' activity.pk %}" style="display:none;"></a>
        {% endif %}
        </p>
    </div>

    <div class="col-md-4">
        <!-- DATE AND TIME -->
        <h6 class="bold-text" style="margin-top:5%;">Date and Time</h6>
        <!--    Activities that only occur once -->
        {% if activity.term == 'Once' %}
        {% if activity.activity_date %}
        <h6>{{ activity.activity_date|date:'D, d F Y' }}</h6>
        {% endif %}
        {% endif %}
        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if activity.term != 'Once' %}
        {% if activity.term != 'Daily' %}
        <h6>Every {{ activity.activity_day }} from {{ activity.start_date|date:'D, d F Y' }} to {{ activity.end_date|date:'D, d F Y' }}</h6>
        {% else %}
        <h6>Every day from {{ activity.start_date|date:'D, d M Y' }} to {{ activity.end_date|date:'D, d F Y' }}</h6>
        {% endif %}
        {% endif %}
        <h6>{{ activity.start_time|time:'g:iA'|lower }} - {{ activity.end_time|time:'g:iA'|lower }}</h6>

        <!-- LOCATION -->
        <h6 class="bold-text mt-4">Location</h6>
        {% if activity.location %}
        <h6 id="address">{{ activity.location }} {{ activity.postcode }}</h6>
        <h6><a href=# id="address2" style="color:#5DAE69;">Open in Google Maps</a></h6>
        {% else %}
        <h6><i>Location hasn't been specified</i></h6>
        {% endif %}

        <!-- ORGANISER -->
        <h6 class="bold-text mt-4">Contact Organiser</h6>
        {% if activity.organiser %}
        <p class="light-text">{{ activity.organiser }} {{ activity.contact_number }}</p>
        {% else %}
        <p class="light-text small"><i>Organiser contact hasn't been specified</i></p>
        {% endif %}

        <!-- COST -->
        {% if activity.cost_choice == 'N' %}<span class="bold-text">FREE!</span>
        {% else %}<span class="bold-text">AUD {{ activity.cost }}</span>{% endif %}

    </div>
    </div>
</div>