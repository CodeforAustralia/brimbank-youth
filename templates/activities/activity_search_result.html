{% extends 'base.html' %}

{% load static %}

{% block title %}Youth Poster{% endblock %}

{% block stylesheet %}
    <link rel="stylesheet" href="{% static 'css/easy-autocomplete.css' %}">
    <link rel="stylesheet" href="{% static 'css/easy-autocomplete.themes.css' %}">
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/jssocials.css'%}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/jssocials-theme-flat.css'%}" />
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">

    <style>
        .jumbotron {
            position: relative;
            background-color: transparent !important;
            height: 400px;
        }
        .jumbotron .img {
            position: absolute;
            left:0; top:0;
            background-size: cover;
            min-height: 400px;
            width: 100%;
            filter: alpha(opacity=80); /* IE 8 and 9 */
            -moz-opacity:0.8; /* Older than Firefox 0.9 */
            -khtml-opacity: 0.8; /* Safari 1.x (pre WebKit!) */
            opacity: 0.8;
            background-image: url("https://d26uhratvi024l.cloudfront.net/gsc/1KQ6PZ/4d/46/d9/4d46d9554c1843668a672f87a5db51a2/images/3rd_it__youth_worker_logged_in___home_page_b_-__ic/u1395.png?token=5b4cee98f7639d827421370987aacfb7");
            z-index: -1;
        }
        .search-box {
            background-color: rgba(255,255,255,0.3);
            color: rgb(255,255,255);
            text-shadow: 1px 1px white;
        }
    </style>

{% endblock %}

{% block content %}

{% if messages %}
{% for message in messages %}
    <p class="published_message" style="display:none;">{{ message }}</p>
{% endfor %}
{% endif %}

{% include 'activities/includes/search_box.html' %}

{% if activities %}
{% if user.is_authenticated %}

<!-- Floating sharing button starts -->
<div class="float-sm">
    <div class="fl-fl float-sms">
        <!-- <button type="submit" id="id_share_text" class="btn btn-success btn-circle" name="search" value="share"><div style="font-size: 2em;"><i class="far fa-comment-alt"></i></div></button> -->
        <a id="share-text" class="btn btn-success btn-circle" target="_blank" href="#"><img src="{% static 'img/icons/sms.png' %}" style="width:55px;"></a>
    </div>
    <div class="fl-fl float-email">
        <!-- <button type="submit" id="id_share_mobile" class="btn btn-success btn-circle" name="search" value="email"><div style="font-size: 2em;"><i class="far fa-envelope"></i></div></button> -->
        <a id="share-email" class="btn btn-success btn-circle" target="_blank" href="#"><img src="{% static 'img/icons/envelope.png' %}" style="width:50px;"></a>
    </div>
</div>
<!-- Floating sharing button ends -->


<div class="container-fluid">
<h3>Your activities & events</h3>

{% else %}
<div class="container-fluid">
<h3>Activities & events</h3>
{% endif %}
<div class="row justify-content-center">
{% if latest_activity and user.is_authenticated %}
<div class="col-sm-4" id="latest_activity" style="display:none; background:mistyrose;">
    <div class="latest_activity_{{ latest_activity.id }}" id="latest_activity_val" style="display:none;"> </div>
    <div class="card select">
    {% if latest_activity.activity_img %}
        <img class="card-img-top select" src="{{ latest_activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';" style="object-fit:cover;margin:auto;height:300px;display:inline;">
        <img class="selectedImg select" src="{% static 'img/checked.png' %}" style="display:none">
    {% else %}
        <img class="card-img-top select" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;">
        <img class="selectedImg select" src="{% static 'img/checked.png' %}" style="display:none">
    {% endif %}
    <div class="card-body select" id=card_{{ latest_activity.pk }} value="{{ latest_activity.pk }}">
        <p id="b" class="card-text small">{{ latest_activity.activity_type|upper }}</p>
        <h3 id="a" class="card-title"><a href="{% url 'activity_detail' latest_activity.pk %}">{{ latest_activity.name }}</a></h3>
        <p class="card-text small"><a href=# name="address">{{ latest_activity.location }}</a></p>

        <!--    Activities that only occur once -->
        {% if latest_activity.term == 'Once' %}
        {% if latest_activity.activity_date %}
        <p class="card-text">{{ latest_activity.activity_date|date:'D, d M Y'|upper }} - {{ latest_activity.start_time|time:'g:i A' }}</p>
        {% endif %}
        {% endif %}

        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if latest_activity.term != 'Once' %}
        {% if latest_activity.term != 'Daily' %}
        <p class="card-text">Every {{ latest_activity.activity_day }} from {{ latest_activity.start_date|date:'D, d M Y' }} - {{ latest_activity.start_time|time:'g:i A' }}</p>
        {% else %}
        <p class="card-text">Every day from {{ latest_activity.start_date|date:'D, d M Y' }} - {{ latest_activity.start_time|time:'g:i A' }}</p>
        {% endif %}
        {% endif %}

        <input class="selected" style="display:none;" type="checkbox" id=activity_{{ latest_activity.pk }} name ="checkboxes" value={{ latest_activity.pk }}>
        <span style="color:green;" class="far fa-circle fa-3x float-right tickbox"></span>
        <span style="display:none;color:green;" class="far fa-check-circle fa-3x float-right tickboxSelected"></span>
    </div>
    <div class="card-footer">
        <a target="_blank" href="{% url 'sms_create' latest_activity.pk %}" class="btn btn-outline-primary float-right share_btn"><i class="fas fa-mobile-alt"></i></a>
        <a target="_blank" href="{% url 'email_create' latest_activity.pk %}" class="btn btn-outline-primary float-right mr-2 share_btn"><i class="far fa-envelope"></i></a>
        
        <!-- Bookmark button -->
        {% if latest_activity.bookmarked %}
        {% for bookmark_user in latest_activity.bookmarked_users.all %}
        {% if bookmark_user.username == user.username %}
        <button onclick="markActivity(this.id)" id={{ latest_activity.id }} type="button" class="btn js-bookmark-article active" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="far fa-bookmark"></i>
        </button>
        {% endif %}
        {% endfor %}
        {% endif %}
        <button onclick="markActivity(this.id)" id={{ latest_activity.id }} type="button" class="btn js-bookmark-article remove" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="far fa-bookmark"></i>
        </button>
        <!-- End of bookmark button -->
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ latest_activity.id }}" value="{% url 'activity_detail' latest_activity.id %}" type="button" class="btn btn-primary mr-2" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="fas fa-share"></i>
        </button>
    </div>
    </div>
</div>
{% endif %}

{% for activity in activities %}
<div class="col-sm-4 activity" id="activity_{{ activity.id }}">
    {% if user.is_authenticated %}
    <div class="card select">
    {% if activity.activity_img %}
        <img class="card-img-top select" src="{{ activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';" style="object-fit:cover;margin:auto;height:300px;display:inline;">
        <img class="selectedImg select" src="{% static 'img/checked.png' %}" style="display:none">
    {% else %}
        <img class="card-img-top select" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;">
        <img class="selectedImg select" src="{% static 'img/checked.png' %}" style="display:none">
    {% endif %}
    <div class="card-body select" id=card_{{ activity.pk }} value="{{ activity.pk }}">
        <p id="b" class="card-text small">{{ activity.activity_type|upper }}</p>
        <h3 id="a" class="card-title"><a href="{% url 'activity_detail' activity.pk %}">{{ activity.name }}</a></h3>
        <p class="card-text small"><a href=# name="address">{{ activity.location }}</a></p>

        <!--    Activities that only occur once -->
        {% if activity.term == 'Once' %}
        {% if activity.activity_date %}
        <p class="card-text">{{ activity.activity_date|date:'D, d M Y'|upper }} - {{ activity.start_time|time:'g:i A' }}</p>
        {% endif %}
        {% endif %}

        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if activity.term != 'Once' %}
        {% if activity.term != 'Daily' %}
        <p class="card-text">Every {{ activity.activity_day }} from {{ activity.start_date|date:'D, d M Y' }} - {{ activity.start_time|time:'g:i A' }}</p>
        {% else %}
        <p class="card-text">Every day from {{ activity.start_date|date:'D, d M Y' }} - {{ activity.start_time|time:'g:i A' }}</p>
        {% endif %}
        {% endif %}

        <input class="selected" style="display:none;" type="checkbox" id=activity_{{ activity.pk }} name ="checkboxes" value={{ activity.pk }}>
        <span style="color:green;" class="far fa-circle fa-3x float-right tickbox"></span>
        <span style="display:none;color:green;" class="far fa-check-circle fa-3x float-right tickboxSelected"></span>
    </div>
    <div class="card-footer">
        <a target="_blank" href="{% url 'sms_create' activity.pk %}" class="btn btn-outline-primary float-right share_btn"><i class="fas fa-mobile-alt"></i></a>
        <a target="_blank" href="{% url 'email_create' activity.pk %}" class="btn btn-outline-primary float-right mr-2 share_btn"><i class="far fa-envelope"></i></a>
        
        <!-- Bookmark button -->
        {% if activity.bookmarked %}
        {% for bookmark_user in activity.bookmarked_users.all %}
        {% if bookmark_user.username == user.username %}
        <button onclick="markActivity(this.id)" id={{ activity.id }} type="button" class="btn js-bookmark-article active" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="far fa-bookmark"></i>
        </button>
        {% endif %}
        {% endfor %}
        {% endif %}
        <button onclick="markActivity(this.id)" id={{ activity.id }} type="button" class="btn js-bookmark-article remove" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="far fa-bookmark"></i>
        </button>
        <!-- End of bookmark button -->
        
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ activity.id }}" value="{% url 'activity_detail' activity.id %}" type="button" class="btn btn-primary mr-2" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="fas fa-share"></i>
        </button>
    </div>
    </div>
    
    {% else %}
    <div class="card">
    {% if activity.activity_img %}
        <a href="{% url 'activity_detail' activity.pk %}"><img class="card-img-top" src="{{ activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';"; style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% else %}
        <a href="{% url 'activity_detail' activity.pk %}"> <img class="card-img-top" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% endif %}
    <div class="card-body" id=card_{{ activity.pk }}>
    <p id="b" class="card-text small">{{ activity.activity_type|upper }}</p>
    <h3 id="a" class="card-title"><a href="{% url 'activity_detail' activity.pk %}">{{ activity.name }}</a></h3>
    <p class="card-text small"><a href=# name="address">{{ activity.location }}</a></p>
    <!--    Activities that only occur once -->
    {% if activity.term == 'Once' %}
    {% if activity.activity_date %}
    <p class="card-text">{{ activity.activity_date|date:'D, d M Y'|upper }} - {{ activity.start_time|time:'g:i A' }}</p>
    {% endif %}
    {% endif %}

    <!--      Daily, weekly, fortnightly, monthly activities-->
    {% if activity.term != 'Once' %}
    {% if activity.term != 'Daily' %}
    <p class="card-text">Every {{ activity.activity_day }} from {{ activity.start_date|date:'D, d M Y' }} - {{ activity.start_time|time:'g:i A' }}</p>
    {% else %}
    <p class="card-text">Every day from {{ activity.start_date|date:'D, d M Y' }} - {{ activity.start_time|time:'g:i A' }}</p>
    {% endif %}
    {% endif %}
    <input class="selected" type="checkbox" style="display:none" id=activity_{{ activity.pk }} name ="checkboxes" value={{ activity.pk }} />
    </div>
    <div class="card-footer">
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ activity.id }}" value="{% url 'activity_detail' activity.id %}" type="button" class="btn btn-primary mr-2" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="fas fa-share"></i>
        </button>
    </div>
    </div>
    {% endif %}
    <br />
</div>

<!-- THE MODAL FOR SHARING URL -->
<!-- <div class="container-fluid"> -->
<div class="modal fade" id="modal_{{ activity.id }}">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
        <h4 class="modal-title">Share the link</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <!-- <div class="modal-body"> -->
            <!-- <div class="container"> -->
                <div id="div_desktop" class="row mt-2" style="align-content:center;">
                    <div id="share2_{{ activity.id }}" class="offset-md-3 mr-2"></div>
                    <!-- <div class="col-md-1 mr-2"> -->
                    <div id="share3_{{ activity.id }}" class="float-left mr-2"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 ml-2 mr-2"> -->
                    <div class="jssocials send_dialog float-left mr-2">
                        <div class="jssocials-shares">
                        <div class="jssocials-share jssocials-share-messenger2">
                            <button type="button" onclick="sendDialog(this.id)" target="_self" id="send_dialog_{% url 'activity_detail' activity.pk %}" class="btn btn-primary send_dialog2" style="width:50px; height:40px;"><i class="fab fa-facebook-messenger fa-lg"></i></button>
                        </div>
                        </div>
                    </div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 offset-md-3 mr-2"> -->
                    <div id="share4_{{ activity.id }}" class="mr-2 share4 float-left"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 mr-2"> -->
                    <div id="share5_{{ activity.id }}" class="mr-2 share5 float-left"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1"> -->
                    <div id="share_{{ activity.id }}" class="mr-2 share float-left"></div>
                    <!-- </div> -->
                </div>
            <!-- </div> -->
        <!-- </div> -->
    <!-- <div class="modal-footer"> -->
        <!-- <div class="container-fluid"> -->
        <div class="row mt-2 ml-3 mr-1">
        <!-- <div class="col-sm-2"> -->
        <input style="width:85%;" class="form-control mr-2" readonly type="text" id="textshow_{{ activity.id }}" value="http://{{ domain }}{% url 'activity_detail' activity.pk %}">
        <!-- </div> -->
        <!-- <div class="col-sm-1"> -->
        <button class="btn btn-outline-success" type="button" onclick="copyURL(this.id)" id="cpbtn_{{ activity.id }}"><i class="far fa-copy"></i></button>
        <!-- </div> -->
        </div>
        <div class="row ml-3 mt-1">
        <p class="small" id="input_{{ activity.id }}"></p>
        </div>
        <!-- </div> -->
    <!-- </div> -->
    </div>
    </div>
</div>
<!-- </div> -->
{% endfor %}
</div>
<!-- </div> -->

<!-- {% if user.is_authenticated %} -->
<!-- {% if activities %} -->
<!-- <div id="yw_share_desktop" class="container-fluid col-sm-1 mr-0" style="height:10%;margin-top:5%;">
    <button type="submit" id="id_share_text" class="btn btn-outline-success btn-circle" name="search" value="share"><div style="font-size:2em;"><i class="far fa-comment-alt"></i></div></button>
    <button type="submit" id="id_share_mobile" class="btn btn-outline-success btn-circle" name="search" value="email"><div style="font-size:2em;"><i class="far fa-envelope"></i></div></button>
</div> -->
<!-- {% endif %} -->
<!-- {% endif %} -->

</div>

{% include 'includes/pagination_2.html' %}

{% else %}
<div class="container-fluid">
    {% if user.is_authenticated %}
    <h3>Your activities & events</h3>
    {% else %}
    <h3>Activities & events</h3>
    {% endif %}
    <p class="lead" style="text-align:center;">No activity that matches the search query</p>
</div>
{% endif %}
</form>

{% if not user.is_authenticated %}
{% if other_activities %}
<div class="container-fluid" style="background:rgb(244, 248, 250); padding-top:1%">
<h3 class="mb-3">Other activities and events in this area</h3>
<div class="row">
{% for other_activity in other_activities %}
<div class="col-sm-4">
<div class="card mb-4">
    {% if other_activity.activity_img %}
        <a href="{% url 'activity_detail' other_activity.pk %}"><img class="card-img-top" src="{{ other_activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';"; style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' other_activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% else %}
        <a href="{% url 'activity_detail' other_activity.pk %}"> <img class="card-img-top" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' other_activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% endif %}
    <div class="card-body" id=card_{{ other_activity.pk }}>
        <p id="b" class="card-text small">{{ other_activity.activity_type|upper }}</p>
        <h3 id="a" class="card-title"><a href="{% url 'activity_detail' other_activity.pk %}">{{ other_activity.name }}</a></h3>
        <p class="card-text small"><a href=# name="address">{{ other_activity.location }}</a></p>

        <!--    Activities that only occur once -->
        {% if other_activity.term == 'Once' %}
        {% if other_activity.activity_date %}
        <p class="card-text">{{ other_activity.activity_date|date:'D, d M Y'|upper }} - {{ other_activity.start_time|time:'g:i A' }}</p>
        {% endif %}
        {% endif %}

        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if other_activity.term != 'Once' %}
        {% if other_activity.term != 'Daily' %}
        <p class="card-text">Every {{ other_activity.activity_day }} from {{ other_activity.start_date|date:'D, d M Y' }} - {{ other_activity.start_time|time:'g:i A' }}</p>
        {% else %}
        <p class="card-text">Every day from {{ other_activity.start_date|date:'D, d M Y' }} - {{ other_activity.start_time|time:'g:i A' }}</p>
        {% endif %}
        {% endif %}

        <input class="selected" type="checkbox" style="display:none" id=activity_{{ other_activity.pk }} name ="checkboxes" value={{ other_activity.pk }} />
    </div>
    <div class="card-footer">
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ other_activity.id }}" value="{% url 'activity_detail' other_activity.id %}" type="button" class="btn btn-primary mr-2" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="fas fa-share"></i>
        </button>
    </div>
</div>

<!-- THE MODAL FOR SHARING URL -->
<!-- <div class="container-fluid"> -->
<div class="modal fade" id="modal_{{ other_activity.id }}">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
        <h4 class="modal-title">Share the link</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <!-- <div class="modal-body"> -->
            <!-- <div class="container"> -->
                <div id="div_desktop" class="row mt-2" style="align-content:center;">
                    <div id="share2_{{ other_activity.id }}" class="offset-md-3 mr-2"></div>
                    <!-- <div class="col-md-1 mr-2"> -->
                    <div id="share3_{{ other_activity.id }}" class="float-left mr-2"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 ml-2 mr-2"> -->
                    <div class="jssocials send_dialog float-left mr-2">
                        <div class="jssocials-shares">
                        <div class="jssocials-share jssocials-share-messenger2">
                            <button type="button" onclick="sendDialog(this.id)" target="_self" id="send_dialog_{% url 'activity_detail' other_activity.pk %}" class="btn btn-primary send_dialog2" style="width:50px; height:40px;"><i class="fab fa-facebook-messenger fa-lg"></i></button>
                        </div>
                        </div>
                    </div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 offset-md-3 mr-2"> -->
                    <div id="share4_{{ other_activity.id }}" class="mr-2 share4 float-left"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 mr-2"> -->
                    <div id="share5_{{ other_activity.id }}" class="mr-2 share5 float-left"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1"> -->
                    <div id="share_{{ other_activity.id }}" class="mr-2 share float-left"></div>
                    <!-- </div> -->
                </div>
            <!-- </div> -->
        <!-- </div> -->
    <!-- <div class="modal-footer"> -->
        <!-- <div class="container-fluid"> -->
        <div class="row mt-2 ml-3 mr-1">
        <!-- <div class="col-sm-2"> -->
        <input style="width:85%;" class="form-control mr-2" readonly type="text" id="textshow_{{ other_activity.id }}" value="http://{{ domain }}{% url 'activity_detail' other_activity.pk %}">
        <!-- </div> -->
        <!-- <div class="col-sm-1"> -->
        <button class="btn btn-outline-success" type="button" onclick="copyURL(this.id)" id="cpbtn_{{ other_activity.id }}"><i class="far fa-copy"></i></button>
        <!-- </div> -->
        </div>
        <div class="row ml-3 mt-1">
        <p class="small" id="input_{{ other_activity.id }}"></p>
        </div>
        <!-- </div> -->
    <!-- </div> -->
    </div>
    </div>
</div>

</div>
{% endfor %}
</div>
</div>
{% endif %}
{% endif %}

{% if user.is_authenticated %}
{% if not_my_activities %}
<div class="container-fluid" style="background:rgb(244, 248, 250); padding-top:1%">
<h3 class="mb-3">Other activities and events in this area</h3>
<div class="row">
{% for not_my_activity in not_my_activities %}
<div class="col-sm-4">
<div class="card select mb-4">
    {% if not_my_activity.activity_img %}
        <a href="{% url 'activity_detail' not_my_activity.pk %}"><img class="card-img-top" src="{{ not_my_activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';"; style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' not_my_activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% else %}
        <a href="{% url 'activity_detail' not_my_activity.pk %}"> <img class="card-img-top" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' not_my_activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% endif %}
    <div class="card-body select" id=card_{{ not_my_activity.pk }} value="{{ not_my_activity.pk }}">
        <p id="b" class="card-text small">{{ not_my_activity.activity_type|upper }}</p>
        <h3 id="a" class="card-title"><a href="{% url 'activity_detail' not_my_activity.pk %}">{{ not_my_activity.name }}</a></h3>
        <p class="card-text small"><a href=# name="address">{{ not_my_activity.location }}</a></p>
        <!--    Activities that only occur once -->
        {% if not_my_activity.term == 'Once' %}
        {% if not_my_activity.activity_date %}
        <p class="card-text">{{ not_my_activity.activity_date|date:'D, d M Y'|upper }} - {{ not_my_activity.start_time|time:'g:i A' }}</p>
        {% endif %}
        {% endif %}

        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if not_my_activity.term != 'Once' %}
        {% if not_my_activity.term != 'Daily' %}
        <p class="card-text">Every {{ not_my_activity.activity_day }} from {{ not_my_activity.start_date|date:'D, d M Y' }} - {{ not_my_activity.start_time|time:'g:i A' }}</p>
        {% else %}
        <p class="card-text">Every day from {{ not_my_activity.start_date|date:'D, d M Y' }} - {{ not_my_activity.start_time|time:'g:i A' }}</p>
        {% endif %}
        {% endif %}
        <input class="selected" type="checkbox" style="display:none" id=activity_{{ not_my_activity.pk }} name ="checkboxes" value={{ not_my_activity.pk }} />
        <span style="color:green;" class="far fa-circle fa-3x float-right tickbox"></span>
        <span style="display:none;color:green;" class="far fa-check-circle fa-3x float-right tickboxSelected"></span>
    </div>
    <div class="card-footer">
        <a target="_blank" href="{% url 'sms_create' not_my_activity.pk %}" class="btn btn-outline-primary float-right share_btn"><i class="fas fa-mobile-alt"></i></a>
        <a target="_blank" href="{% url 'email_create' not_my_activity.pk %}" class="btn btn-outline-primary float-right mr-2 share_btn"><i class="far fa-envelope"></i></a>
        
        {% if not_my_activity.bookmarked %}
        {% for bookmark_user in not_my_activity.bookmarked_users.all %}
        {% if bookmark_user.username == user.username %}
        <button onclick="markActivity(this.id)" id={{ not_my_activity.id }} type="button" class="btn js-bookmark-article active" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="far fa-bookmark"></i>
        </button>
        {% endif %}
        {% endfor %}
        {% endif %}
        <button onclick="markActivity(this.id)" id={{ not_my_activity.id }} type="button" class="btn js-bookmark-article remove" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="far fa-bookmark"></i>
        </button>
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ not_my_activity.id }}" value="{% url 'activity_detail' not_my_activity.id %}" type="button" class="btn btn-primary mr-2" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="fas fa-share"></i>
        </button>
    </div>
</div>
</div>
<!-- THE MODAL FOR SHARING URL -->
<!-- <div class="container-fluid"> -->
<div class="modal fade" id="modal_{{ not_my_activity.id }}">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
        <h4 class="modal-title">Share the link</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <!-- <div class="modal-body"> -->
            <!-- <div class="container"> -->
                <div id="div_desktop" class="row mt-2" style="align-content:center;">
                    <div id="share2_{{ not_my_activity.id }}" class="offset-md-3 mr-2"></div>
                    <!-- <div class="col-md-1 mr-2"> -->
                    <div id="share3_{{ not_my_activity.id }}" class="float-left mr-2"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 ml-2 mr-2"> -->
                    <div class="jssocials send_dialog float-left mr-2">
                        <div class="jssocials-shares">
                        <div class="jssocials-share jssocials-share-messenger2">
                            <button type="button" onclick="sendDialog(this.id)" target="_self" id="send_dialog_{% url 'activity_detail' not_my_activity.pk %}" class="btn btn-primary send_dialog2" style="width:50px; height:40px;"><i class="fab fa-facebook-messenger fa-lg"></i></button>
                        </div>
                        </div>
                    </div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 offset-md-3 mr-2"> -->
                    <div id="share4_{{ not_my_activity.id }}" class="mr-2 share4 float-left"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1 mr-2"> -->
                    <div id="share5_{{ not_my_activity.id }}" class="mr-2 share5 float-left"></div>
                    <!-- </div> -->
                    <!-- <div class="col-md-1"> -->
                    <div id="share_{{ not_my_activity.id }}" class="mr-2 share float-left"></div>
                    <!-- </div> -->
                </div>
            <!-- </div> -->
        <!-- </div> -->
    <!-- <div class="modal-footer"> -->
        <!-- <div class="container-fluid"> -->
        <div class="row mt-2 ml-3 mr-1">
        <!-- <div class="col-sm-2"> -->
        <input style="width:85%;" class="form-control mr-2" readonly type="text" id="textshow_{{ not_my_activity.id }}" value="http://{{ domain }}{% url 'activity_detail' not_my_activity.pk %}">
        <!-- </div> -->
        <!-- <div class="col-sm-1"> -->
        <button class="btn btn-outline-success" type="button" onclick="copyURL(this.id)" id="cpbtn_{{ not_my_activity.id }}"><i class="far fa-copy"></i></button>
        <!-- </div> -->
        </div>
        <div class="row ml-3 mt-1">
        <p class="small" id="input_{{ not_my_activity.id }}"></p>
        </div>
        <!-- </div> -->
    <!-- </div> -->
    </div>
    </div>
    </div>
{% endfor %}
</div>
</div>
{% endif %}
{% endif %}

<!-- {% if not user.is_authenticated %}
<div class="sharethis-inline-share-buttons"></div>
{% endif %} -->

{% endblock %}

{% block javascript %}
<script src="{% static 'js/jquery.easy-autocomplete.js' %}"></script>
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<script src="{% static 'activities/js/bookmarks.js' %}"></script>

<!-- <script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5a2f1bb7fce9e20013a73372&product=inline-share-buttons"></script> -->

<!-- <script type="text/javascript" data-cfasync="false" src="//dsms0mj1bbhn4.cloudfront.net/assets/pub/shareaholic.js" data-shr-siteid="c363c07f4215a1d47d25f47dadb72b05" async="async"></script> -->

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<!-- <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a435c987240088a"></script> -->

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDuR6-6PfCU7wRsSRRR3DH_PseEAYvyp3k&libraries=places&region=au"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.2/js/all.js"></script>
<script src="{% static 'js/jssocials.js' %}"></script>
<script>
function markActivity(clicked_id) {
    var url_dest = '/activity/bookmark/'+clicked_id+'/'
    $.ajax({
        url: url_dest,
        type: 'get',
        dataType: 'json',
        beforeSend: function () {
        },
        success: function(){
            // alert(url_dest);
            $(this).toggleClass('active');
        }
    });
};

window.fbAsyncInit = function() {
FB.init({
    appId            : '1943348669252986',
    autoLogAppEvents : true,
    xfbml            : true,
    version          : 'v2.11'
});
};

(function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));

function sendDialog(id) {
    var url_arr = id.split("send_dialog_/");
    var url = url_arr[1];
    var url_final = window.location.href + url;

    FB.ui({
      method: 'send',
      link: url_final
    });
}

function getURL(id, value) {
    var text_input_arr = id.split("sharebutton_");
    var activity_id = text_input_arr[1];

    var modal_id = "#modal_" + activity_id;
    var input_id = "#input_" + activity_id;

    $(input_id).html("");
    $(modal_id).modal("show");

    var share = "#share_" + activity_id;
    var share2 = "#share2_" + activity_id;
    var share3 = "#share3_" + activity_id;
    var share4 = "#share4_" + activity_id;
    var share5 = "#share5_" + activity_id;

    var url_val = value.substring(1);
    var url_final = window.location.href + url_val;

    $(share).jsSocials({
      shares: ["messenger"],
      showLabel: false,
      shareIn: "popup",
      url: url_final,
    });
    $(share2).jsSocials({
        shares: ["facebook"],
        showLabel: false,
        shareIn: "popup",
        url: url_final,
    });
    $(share3).jsSocials({
        shares: ["email"],
        showLabel: false,
        shareIn: "popup",
        url: url_final,
    });
    $(share4).jsSocials({
        shares: ["whatsapp"],
        showLabel: false,
        shareIn: "popup",
        url: url_final,
    });
    $(share5).jsSocials({
        shares: ["sms"],
        showLabel: false,
        shareIn: "popup",
        url: url_final,
    });
}

function copyURL(id) {
    var msg_arr = id.split("cpbtn_");
    var activity_id = msg_arr[1];
    // alert(activity_id);

    var id_share_url = "textshow_" + activity_id;

    var copyText = document.getElementById(id_share_url);
    copyText.select();
    document.execCommand("Copy");

    var input_id = "#input_" + activity_id;

    $(input_id).html("Link has been copied!");
}
    
$( function() {
   // Add Google Maps URL
   var form_elems = document.getElementsByName("address");
   for (var i = 0; i < form_elems.length; i++) {
       var address = $(form_elems[i]).text();
       var map_url = "https://www.google.com/maps/search/?api=1&query=";
       var full_url = map_url + address;
       $(form_elems[i]).attr("href", full_url);
   }

   // Change apperance of bookmark button when clicked
    $( ".active" ).each(function() {
        $( this ).siblings('.remove').css( "display", "none" );
    });

    var messages = document.getElementsByClassName("published_message");

    for (i = 0; i < messages.length; i++) {
        if (messages[i].innerHTML == 'The activity has been published.') {
            $('#latest_activity').show();

            var id_latest = document.getElementById("latest_activity_val").getAttribute("class");
            var latest_activity_id = id_latest.split("latest_activity_")[1];

            var activities = document.getElementsByClassName("activity");

            for (i = 0; i < activities.length; i++) {
                var id = activities[i].getAttribute("id").split("activity_")[1];
                if (id == latest_activity_id ) {
                    activities[i].style.display = "none";
                    break;
                }
            }
        }
    }

   var isMobile = window.matchMedia("only screen and (max-width: 760px)");

    if (isMobile.matches) {
        $(".send_dialog").hide();
        // $("#yw_share_mobile").show();
        // $("#yw_share_desktop").hide();
    }
    else{
        $(".share").hide();
        $(".share4").hide();
        $(".share5").hide();
    }

  // Add Tooltips on search boxes
  $('#id_location').tooltip();
  $('#id_name').tooltip();

  var checkbox_arr = [];

  // Dynamically display checkboxes
  $('.card-body.select').click( function() {
      //Change the background colour of card-body
      $(this).toggleClass('on');
      var val = $(this).attr('value');

      if ($(this).hasClass('on')) {
        if (!checkbox_arr.includes(val)) {
            checkbox_arr.push(val);
        }
        console.log(checkbox_arr);
      } else {
            if (checkbox_arr.includes(val)) {
                var index = checkbox_arr.indexOf(val);
                checkbox_arr.splice(index, 1);
        }
        console.log(checkbox_arr);
      }

      var href;
      var sms_url, email_url;
      if (checkbox_arr != []) {
          href = checkbox_arr.join('_');
      }
      console.log(href);

      var ori_url = (window.location.href).toString();
      var web_url = (ori_url.substr(0, ori_url.indexOf('?')));

      console.log(web_url);

      if (href != '') {
        sms_url = web_url + "sms_create/" + href + "/";
        email_url = web_url + "email_create/" + href + "/";
      } else {
        sms_url = "#";
        email_url = "#";
      }
      
      $("#share-text").attr("href", sms_url);
      $("#share-email").attr("href", email_url);

      //change opacity of card-img-top
      $(this).siblings(".card-img-top.select").toggleClass('on');
      
//      card.children(".card-img-top").toggleClass('on');
      
      //show the checklist icon
    //   $(this).siblings(".selectedImg.select").toggle();
      $(this).children(".tickbox").toggle();
      $(this).children(".tickboxSelected").toggle();
//      card.children(".selectedImg").toggle();
      
      //checked the checkbox element
      var checkbox = $(this).children(".selected");
      checkbox.prop("checked", !checkbox.prop("checked"));
      
      //alert($(this).parent(".selected").attr("class"));
  })
    
//   $('.card-img-top.select').click( function() {
//       //Change the background colour of card-body
//       $(this).siblings(".card-body.select").toggleClass('on');
      
//       //change opacity of card-img-top
//       $(this).toggleClass('on');
      
//       //show the checklist icon
//     //   $(this).siblings(".selectedImg.select").toggle();
      
//       //checked the checkbox element
//       var card_body = $(this).siblings(".card-body.select");
//       var checkbox = card_body.children(".selected");
//       checkbox.prop("checked", !checkbox.prop("checked"));
//   })

  var id_form = document.getElementById("id_form");
    $('#id_share_text').click(function(){
        id_form.setAttribute("target", "_blank");
    })
    $('#id_share_mobile').click(function(){
        id_form.setAttribute("target", "_blank");
    })
    $('.share_btn').click(function(){
        id_form.setAttribute("target", "_blank");
    })

});
</script>

{% endblock %} 