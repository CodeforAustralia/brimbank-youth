{% extends 'base.html' %}

{% load static %}

{% block title %}YouShare{% endblock %}

{% block stylesheet %}
    <link rel="stylesheet" href="{% static 'css/easy-autocomplete.css' %}">
    <link rel="stylesheet" href="{% static 'css/easy-autocomplete.themes.css' %}">
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/jssocials.css'%}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/jssocials-theme-flat.css'%}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/swiper.css'%}" />
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">

    <style>
    #id_name, #id_location {
        border-radius: 0;
        font-size:20px;
    }
    .signature-grey {
        color: #484848;
    }
    .btn-green {
        background: #5DAE69;
        color: #FFFFFF;
    }
    .card-padding {
        padding-left:0;
        padding-right:0;
        padding-top: 4px;
    }
    .swiper-container {
      width: 100%;
      height: 100%;
    }
    .swiper-slide {
      text-align: center;
      font-size: 18px;
      background: #fff;
      /* Center slide text vertically */
      display: -webkit-box;
      display: -ms-flexbox;
      display: -webkit-flex;
      display: flex;
      -webkit-box-pack: center;
      -ms-flex-pack: center;
      -webkit-justify-content: center;
      justify-content: center;
      -webkit-box-align: center;
      -ms-flex-align: center;
      -webkit-align-items: center;
      align-items: center;
    }
    .category {
        font-weight: bold;
        color: #484848;
    }

    .jumbotron {
        position: relative;
        background-color: transparent !important;
        height: 640px;
        padding-top: 160px;
        padding-bottom: 40px;
    }
    .jumbotron .img {
        position: absolute;
        left:0; top:0;
        background-size: cover;
        min-height: 640px;
        width: 100%;
        /* filter: alpha(opacity=80); IE 8 and 9
        -moz-opacity:0.8; Older than Firefox 0.9
        -khtml-opacity: 0.8; Safari 1.x (pre WebKit!)
        opacity: 0.8; */
        background-image: url("/static/img/cover_search.png");
        z-index: -1;
    }
    .search-box {
        /* background-color: rgba(255,255,255,0.3); */
        background-color:rgba(102,102,102,0.4);
        color: rgb(255,255,255);
        border-radius:5px;
        border-style: solid;
        border-width: 0.04rem;
        border-color: rgba(153,153,153,0.4);
        width: 90%;
        /* margin-bottom: 80px; */
        /* text-shadow: 1px 1px white; */
    }
    .card {
        border: transparent;
    }
    .indicator {
        height: 5px;
        background: #A9DFF8;
        border: none;
    }
    </style>

{% endblock %}

{% block content %}

{% if messages %}
{% for message in messages %}
    <p class="published_message" style="display:none;">{{ message }}</p>
{% endfor %}
{% endif %}

{% include 'activities/includes/search_box.html' %}

<!-- Floating sharing button starts -->
<div class="float-sm">
    <div class="fl-fl float-sms">
        <!-- <button type="submit" id="id_share_text" class="btn btn-success btn-circle" name="search" value="share"><div style="font-size: 2em;"><i class="far fa-comment-alt"></i></div></button> -->
        <!-- <a id="share-text" class="btn btn-circle" href="#" style="background:#ffc600;"><img src="{% static 'img/icons/sms.png' %}" style="width:55px;"></a> -->
    </div>
    <div class="fl-fl float-email">
        <!-- <button type="submit" id="id_share_mobile" class="btn btn-success btn-circle" name="search" value="email"><div style="font-size: 2em;"><i class="far fa-envelope"></i></div></button> -->
        <!-- <a id="share-email" class="btn btn-circle" href="#" style="background:rgb(128, 128, 128);">
            <img src="{% static 'img/icons/envelope.png' %}" style="width:50px;"></a> -->
    </div>
</div>
<!-- Floating sharing button ends -->

{% if category != '' %}
<div class="container" style="margin-bottom:2%;">
<p class="lead">{{ activities_count }} result{{ activities|pluralize }} found for <strong>{{category}}</strong></p>
</div>
{% endif %}

{% if name_key != '' %}
<div class="container" style="margin-bottom:2%;">
<p class="lead">{{ activities_count }} result{{ activities|pluralize }} found for <strong>{{name_key}}</strong></p>
</div>
{% endif %}

{% if activities %}
{% if user.is_authenticated %}
<div class="container">
<h2 class='signature-grey'>Your activities & events</h2>
{% else %}
<div class="container">
<h2 class='signature-grey'>Activities & events</h2>
{% endif %}
<div class="row justify-content-center" style="margin-top:40px;">
{% if latest_activity and user.is_authenticated %}
<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 col-xs-12" id="latest_activity" style="display:none;">
    <div class="latest_activity_{{ latest_activity.id }}" id="latest_activity_val" style="display:none;"> </div>
    <div class="card hover-card select" style="box-shadow: 0 8px 12px 0 rgba(0, 0, 0, 0.2), 0 10px 20px 0 rgba(0, 0, 0, 0.19);">
    {% if latest_activity.activity_img %}
        <img class="card-img-top select" src="{{ latest_activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';" style="object-fit:cover;margin:auto;height:300px;display:inline;">
        <img class="selectedImg select" src="{% static 'img/checked.png' %}" style="display:none">
    {% else %}
        <img class="card-img-top select" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;">
        <img class="selectedImg select" src="{% static 'img/checked.png' %}" style="display:none">
    {% endif %}
    <div class="top">
        <span class="far fa-heart fa-2x float-right tickbox mr-2 mt-2"></span>
        <span style="display:none;" class="fas fa-heart fa-2x float-right tickboxSelected mr-2 mt-2"></span>
        <a href="{% url 'activity_detail' latest_activity.pk %}" 
        class="btn btn-dark btn-lg vertical-button">VIEW ACTIVITY</a>
    </div>
    <div class="card-body card-padding select" id=card_{{ latest_activity.pk }} value="{{ latest_activity.pk }}">
        <p id="b" class="card-text bold-text">{{ latest_activity.activity_type|upper }} - {{ latest_activity.suburb|upper }}
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ latest_activity.id }}" 
        value="{% url 'activity_detail' latest_activity.id %}" type="button" class="btn btn-transparent float-right" 
        data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off" style="margin-top:-5px; padding-right:0; color:#484848;">
        <img src="{% static 'img/icons/share.svg' %}" height="30"> Share
        </button></p>
        <h3 id="a" class="card-title">{{ latest_activity.name }}</h3>
        <!-- <p class="card-text small"><a href=# name="address">{{ latest_activity.location }}</a></p> -->

        <!--    Activities that only occur once -->
        {% if latest_activity.term == 'Once' %}
        {% if latest_activity.activity_date %}
        <!-- <p class="card-text">{{ latest_activity.activity_date|date:'D, d M Y'|upper }}  {{ latest_activity.start_time|time:'g:iA' }}</p> -->
        <p class="card-text lead">{{ latest_activity.activity_date|date:'D, d M' }}  {{ latest_activity.start_time|time:'g:ia' }}</p>
        {% endif %}
        {% endif %}

        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if latest_activity.term != 'Once' %}
        {% if latest_activity.term != 'Daily' %}
        <p class="card-text lead">Every {{ latest_activity.activity_day }} until {{ latest_activity.end_date|date:'D, d M' }}  {{ latest_activity.start_time|time:'g:iA' }}</p>
        {% else %}
        <p class="card-text lead">Every day until {{ latest_activity.end_date|date:'D, d M' }}  {{ latest_activity.start_time|time:'g:iA' }}</p>
        {% endif %}
        {% endif %}
        <input class="selected" style="display:none;" type="checkbox" id=activity_{{ latest_activity.pk }} name ="checkboxes" value={{ latest_activity.pk }}>
    </div>
    </div>
</div>
{% endif %}

{% for activity in activities %}
<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 col-xs-12 activity" id="activity_{{ activity.id }}">
    {% if user.is_authenticated %}
    <div class="card hover-card select">
    {% if activity.activity_img %}
        <img class="card-img-top select" src="{{ activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';" style="object-fit:cover;margin:auto;height:300px;display:inline;">
        <img class="selectedImg select" src="{% static 'img/checked.png' %}" style="display:none">
    {% else %}
        <img class="card-img-top select" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;">
        <img class="selectedImg select" src="{% static 'img/checked.png' %}" style="display:none">
    {% endif %}
    <div class="top">
        <span class="far fa-heart fa-2x float-right tickbox mr-2 mt-2"></span>
        <span style="display:none;" class="fas fa-heart fa-2x float-right tickboxSelected mr-2 mt-2"></span>
        <a href="{% url 'activity_detail' activity.pk %}" class="btn btn-dark btn-lg vertical-button">VIEW ACTIVITY</a>
    </div>
    <div class="card-body card-padding select" id=card_{{ activity.pk }} value="{{ activity.pk }}">
        <p id="b" class="card-text bold-text">{{ activity.activity_type|upper }} - {{ activity.suburb|upper }}
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ activity.id }}" 
        value="{% url 'activity_detail' activity.id %}" type="button" 
        class="btn btn-transparent float-right" data-url="#" data-toggle="button" 
        aria-pressed="false" autocomplete="off" style="margin-top:-5px; padding-right:0;color:#484848;">
        <img src="{% static 'img/icons/share.svg' %}" height="33">&nbsp;&nbsp; Share
        </button></p>
        <h3 id="a" class="card-title">{{ activity.name }}</h3>

        <!--    Activities that only occur once -->
        {% if activity.term == 'Once' %}
        {% if activity.activity_date %}
        <p class="card-text lead">{{ activity.activity_date|date:'D, d M' }}  {{ activity.start_time|time:'g:iA'|lower }}
        </p>
        {% endif %}
        {% endif %}

        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if activity.term != 'Once' %}
        {% if activity.term != 'Daily' %}
        <p class="card-text lead">Every {{ activity.activity_day }} until {{ activity.end_date|date:'D, d M' }} {{ activity.start_time|time:'g:iA'|lower }}
        </p>
        {% else %}
        <p class="card-text lead">Every day until {{ activity.end_date|date:'D, d M' }}  {{ activity.start_time|time:'g:iA'|lower }}
        </p>
        {% endif %}
        {% endif %}

        <p class="card-text" style="color: #484848;">{{ activity.bookings.count }} Registered</p>
        <input class="selected" style="display:none;" type="checkbox" id=activity_{{ activity.pk }} name ="checkboxes" value={{ activity.pk }}>
    </div>
    </div>

    {% else %}
    <div class="card hover-card">
    {% if activity.activity_img %}
        <a href="{% url 'activity_detail' activity.pk %}"><img class="card-img-top" src="{{ activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';"; style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% else %}
        <a href="{% url 'activity_detail' activity.pk %}"> <img class="card-img-top" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% endif %}
    <div class="top">
        <span class="far fa-heart fa-2x float-right tickbox mr-2 mt-2"></span>
        <span style="display:none;" class="fas fa-heart fa-2x float-right tickboxSelected mr-2 mt-2"></span>
        <a href="{% url 'activity_detail' activity.pk %}" class="btn btn-dark btn-lg vertical-button">VIEW ACTIVITY</a>
    </div>
    <div class="card-body card-padding select" id=card_{{ activity.pk }} value="{{ activity.pk }}">
    <p id="b" class="card-text bold-text">{{ activity.activity_type|upper }} - {{ activity.suburb|upper }}
    <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ activity.id }}" 
    value="{% url 'activity_detail' activity.id %}" type="button" 
    class="btn btn-transparent float-right" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off" 
    style="margin-top:-5px; padding-right:0;color:#484848;">
    <img src="{% static 'img/icons/share.svg' %}" height="33">&nbsp;&nbsp; Share
    </button></p>
    <h3 id="a" class="card-title">{{ activity.name }}</h3>
    <!-- <p class="card-text small"><a href=# name="address">{{ activity.location }}</a></p> -->
    <!--    Activities that only occur once -->
    {% if activity.term == 'Once' %}
    {% if activity.activity_date %}
    <p class="card-text lead">{{ activity.activity_date|date:'D, d M' }}  {{ activity.start_time|time:'g:iA'|lower }}</p>
    {% endif %}
    {% endif %}

    <!--      Daily, weekly, fortnightly, monthly activities-->
    {% if activity.term != 'Once' %}
    {% if activity.term != 'Daily' %}
    <p class="card-text lead">Every {{ activity.activity_day }} until {{ activity.end_date|date:'D, d M' }}  {{ activity.start_time|time:'g:iA'|lower }}</p>
    {% else %}
    <p class="card-text lead">Every day until {{ activity.end_date|date:'D, d M' }}  {{ activity.start_time|time:'g:iA'|lower }}</p>
    {% endif %}
    {% endif %}
    <input class="selected" type="checkbox" style="display:none" id=activity_{{ activity.pk }} name ="checkboxes" value={{ activity.pk }} />
    </div>
    <!-- <div class="card-footer">
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ activity.id }}" value="{% url 'activity_detail' activity.id %}" type="button" class="btn btn-primary mr-2" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="fas fa-share"></i>
        </button>
    </div> -->
    </div>
    {% endif %}
    <br />
</div>

<!-- THE MODAL FOR SHARING URL -->
<div class="modal fade" id="modal_{{ activity.id }}">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="modal-title">Share this activity</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="row justify-content-center mt-3">
            <!-- <div class="addthis_inline_share_toolbox" data-url="http://{{ domain }}{% url 'activity_detail' activity.pk %}"></div> -->
            <div class="sharethis-inline-share-buttons" data-url="http://{{ domain }}{% url 'activity_detail' activity.pk %}" 
            data-title="{{ activity.name }}" data-description="Test" data-message="test message"></div>
            <a target="_self" class="btn btn-circle-2 ml-2" 
            href="sms:?&body=Check this out:%0D%0Ahttp://{{ domain }}{% url 'activity_detail' activity.pk %}"
            style="background:#ffc600;width:49px;height:49px;border-radius:100%;color:white;padding:0;">
            <img src="{% static 'img/icons/sms.png' %}" style="width:28px;margin-top:0px;margin-right:-2px;margin-bottom:1px;"></a>
            <a target="_self" class="btn btn-circle-2 ml-2" 
            href="mailto:?subject=Check%20this%20out!&body=Check this out:%0D%0Ahttp://{{ domain }}{% url 'activity_detail' activity.pk %}"
            style="background:grey;width:49px;height:49px;border-radius:100%;color:white;">
            <img src="{% static 'img/icons/envelope.png' %}" style="width:23px;margin-bottom:1px;"></a>
        </div>
        <div class="row mt-3 ml-3 mr-1">
        <input class="form-control text-center mr-2" type="text" id="textshow_{{ activity.id }}" value="http://{{ domain }}{% url 'activity_detail' activity.pk %}">
        <!-- <button class="btn btn-outline-success" type="button" onclick="copyURL(this.id)" id="cpbtn_{{ activity.id }}"><i class="far fa-copy"></i></button> -->
        </div>
        <div class="row ml-3 mt-1">
        <p class="small" id="input_{{ activity.id }}"></p>
        </div>
    </div>
    </div>
</div>
{% endfor %}
</div>

</div>

{% include 'includes/pagination_2.html' %}

{% else %}
<!-- <div class="container">
    {% if user.is_authenticated %}
    <h2>Your activities & events</h2>
    {% else %}
    <h2>Activities & events</h2>
    {% endif %}
    <p class="lead" style="text-align:center;">No activity that matches the search query</p>
</div> -->
{% endif %}
</form>

{% if not user.is_authenticated %}
{% if other_activities %}
<div class="container" style="padding-top:3%">
<h2 class="signature-grey mb-3">Other activities and events</h2>
<div class="row justify-content-center" style="margin-top:4%;">
{% for other_activity in other_activities %}
<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 col-xs-12">
<div class="card hover-card mb-4">
    {% if other_activity.activity_img %}
        <a href="{% url 'activity_detail' other_activity.pk %}"><img class="card-img-top" src="{{ other_activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';"; style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' other_activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% else %}
        <a href="{% url 'activity_detail' other_activity.pk %}"> <img class="card-img-top" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' other_activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% endif %}
    <div class="top">
        <span class="far fa-heart fa-2x float-right tickbox mr-2 mt-2"></span>
        <span style="display:none;" class="fas fa-heart fa-2x float-right tickboxSelected mr-2 mt-2"></span>
        <a href="{% url 'activity_detail' other_activity.pk %}" class="btn btn-dark btn-lg vertical-button">VIEW ACTIVITY</a>
    </div>
    <div class="card-body card-padding select" id=card_{{ other_activity.pk }} value="{{ other_activity.pk }}">
        <p id="b" class="card-text bold-text">{{ other_activity.activity_type|upper }} - {{ other_activity.suburb|upper }}
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ other_activity.id }}" 
        value="{% url 'activity_detail' other_activity.id %}" type="button" class="btn btn-transparent float-right" 
        data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off" style="margin-top:-5px; padding-right:0;color:#484848;">
        <img src="{% static 'img/icons/share.svg' %}" height="33">&nbsp;&nbsp; Share
        </button></p>
        <h3 id="a" class="card-title">{{ other_activity.name }}</h3>
        <!-- <p class="card-text small"><a href=# name="address">{{ other_activity.location }}</a></p> -->

        <!--    Activities that only occur once -->
        {% if other_activity.term == 'Once' %}
        {% if other_activity.activity_date %}
        <p class="card-text lead">{{ other_activity.activity_date|date:'D, d M' }}  {{ other_activity.start_time|time:'g:iA' }}</p>
        {% endif %}
        {% endif %}

        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if other_activity.term != 'Once' %}
        {% if other_activity.term != 'Daily' %}
        <p class="card-text lead">Every {{ other_activity.activity_day }} until {{ other_activity.end_date|date:'D, d M' }}  {{ other_activity.start_time|time:'g:iA' }}</p>
        {% else %}
        <p class="card-text lead">Every day until {{ other_activity.end_date|date:'D, d M' }}  {{ other_activity.start_time|time:'g:iA' }}</p>
        {% endif %}
        {% endif %}
        <input class="selected" type="checkbox" style="display:none" id=activity_{{ other_activity.pk }} name ="checkboxes" value={{ other_activity.pk }} />
    </div>
    <!-- <div class="card-footer">
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ other_activity.id }}" value="{% url 'activity_detail' other_activity.id %}" type="button" class="btn btn-primary mr-2" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="fas fa-share"></i>
        </button>
    </div> -->
</div>

<!-- THE MODAL FOR SHARING URL -->
<!-- <div class="container-fluid"> -->
<div class="modal fade" id="modal_{{ other_activity.id }}">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
        <h4 class="modal-title">Share this activity</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
        </div>
            <!-- <div id="div_desktop" class="row mt-2" style="align-content:center;">
                <div id="share2_{{ other_activity.id }}" class="offset-md-3 mr-2"></div>
                <div id="share3_{{ other_activity.id }}" class="float-left mr-2"></div>
                <div class="jssocials send_dialog float-left mr-2">
                    <div class="jssocials-shares">
                    <div class="jssocials-share jssocials-share-messenger2">
                        <button type="button" onclick="sendDialog(this.id)" target="_self" id="send_dialog_{% url 'activity_detail' other_activity.pk %}" class="btn btn-primary send_dialog2" style="width:50px; height:40px;"><i class="fab fa-facebook-messenger fa-lg"></i></button>
                    </div>
                    </div>
                </div>
                <div id="share4_{{ other_activity.id }}" class="mr-2 share4 float-left"></div>
                <div id="share5_{{ other_activity.id }}" class="mr-2 share5 float-left"></div>
                <div id="share_{{ other_activity.id }}" class="mr-2 share float-left"></div>
            </div> -->
        <div class="row justify-content-center mt-3">
            <!-- <div class="addthis_inline_share_toolbox"></div> -->
            <div class="sharethis-inline-share-buttons" data-url="http://{{ domain }}{% url 'activity_detail' other_activity.id %}" 
            data-title="{{ other_activity.name }}" data-description="Test" data-message="test message"></div>
            <a target="_self" class="btn btn-circle-2 ml-2" 
            href="sms:?&body=Check this out:%0D%0Ahttp://{{ domain }}{% url 'activity_detail' other_activity.pk %}"
            style="background:#ffc600;width:49px;height:49px;border-radius:100%;color:white;padding:0;">
            <img src="{% static 'img/icons/sms.png' %}" style="width:28px;margin-top:0px;margin-right:-2px;margin-bottom:1px;"></a>
            <a target="_self" class="btn btn-circle-2 ml-2" href="mailto:?subject=Check%20this%20out!&body=Check this out:%0D%0Ahttp://{{ domain }}{% url 'activity_detail' other_activity.pk %}"
            style="background:grey;width:49px;height:49px;border-radius:100%;color:white;">
            <img src="{% static 'img/icons/envelope.png' %}" style="width:23px;margin-bottom:1px;"></a>
        </div>
        <div class="row mt-3 ml-3 mr-1">
        <input class="form-control text-center mr-2" type="text" id="textshow_{{ other_activity.id }}" value="http://{{ domain }}{% url 'activity_detail' other_activity.pk %}">
        <!-- <button class="btn btn-outline-success" type="button" onclick="copyURL(this.id)" id="cpbtn_{{ other_activity.id }}"><i class="far fa-copy"></i></button> -->
        </div>
        <div class="row ml-3 mt-1">
        <p class="small" id="input_{{ other_activity.id }}"></p>
        </div>
    </div>
    </div>
</div>

</div>
{% endfor %}
</div>
</div>
{% endif %}
{% endif %}

{% if user.is_authenticated %}
{% if not_my_activities %}
<div class="container" style="padding-top:3%">
<h2 class="signature-grey mb-3">Other activities and events</h2>
<div class="row justify-content-center" style="margin-top:4%;">
{% for not_my_activity in not_my_activities %}
<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 col-xs-12">
<div class="card hover-card select mb-4">
    {% if not_my_activity.activity_img %}
        <a href="{% url 'activity_detail' not_my_activity.pk %}"><img class="card-img-top" src="{{ not_my_activity.activity_img.url }}" alt="Not Found" onerror="this.onerror=null;this.src='http://via.placeholder.com/350x300?text=Image not available';"; style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' not_my_activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% else %}
        <a href="{% url 'activity_detail' not_my_activity.pk %}"> <img class="card-img-top" src="http://via.placeholder.com/350x300?text=Image not available" alt="Not Found" style="object-fit: cover;display:inline;margin:auto;height:300px;"></a>
        <a href="{% url 'activity_detail' not_my_activity.pk %}"><img class="selectedImg" src="{% static 'img/checked.png' %}" style="display:none"></a>
    {% endif %}
    <div class="top">
        <span class="far fa-heart fa-2x float-right tickbox mt-2 mr-2"></span>
        <span style="display:none;" class="fas fa-heart fa-2x float-right tickboxSelected mt-2 mr-2"></span>
        <a href="{% url 'activity_detail' not_my_activity.pk %}" 
        class="btn btn-dark btn-lg vertical-button">VIEW ACTIVITY</a>
    </div>
    <div class="card-body card-padding select" id=card_{{ not_my_activity.pk }} value="{{ not_my_activity.pk }}">
        <p id="b" class="card-text bold-text">{{ not_my_activity.activity_type|upper }} - {{ not_my_activity.suburb|upper }}
        <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ not_my_activity.id }}" 
        value="{% url 'activity_detail' not_my_activity.id %}" type="button" class="btn btn-transparent float-right" 
        data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off" 
        style="margin-top:-5px; padding-right:0;color:#484848;">
        <img src="{% static 'img/icons/share.svg' %}" height="33">&nbsp;&nbsp; Share
        </button></p>
        <h3 id="a" class="card-title">{{ not_my_activity.name }}</h3>
        <!-- <p class="card-text small"><a href=# name="address">{{ not_my_activity.location }}</a></p> -->
        <!--    Activities that only occur once -->
        {% if not_my_activity.term == 'Once' %}
        {% if not_my_activity.activity_date %}
        <p class="card-text lead">{{ not_my_activity.activity_date|date:'D, d M' }}  {{ not_my_activity.start_time|time:'g:iA' }}</p>
        {% endif %}
        {% endif %}

        <!--      Daily, weekly, fortnightly, monthly activities-->
        {% if not_my_activity.term != 'Once' %}
        {% if not_my_activity.term != 'Daily' %}
        <p class="card-text lead">Every {{ not_my_activity.activity_day }} until {{ not_my_activity.end_date|date:'D, d M' }}  {{ not_my_activity.start_time|time:'g:iA' }}</p>
        {% else %}
        <p class="card-text lead">Every day until {{ not_my_activity.end_date|date:'D, d M' }}  {{ not_my_activity.start_time|time:'g:iA' }}
            <!-- <a target="_blank" href="{% url 'sms_create' not_my_activity.pk %}" class="btn btn-outline-primary float-right share_btn"><i class="fas fa-mobile-alt"></i></a> -->
            <!-- <a target="_blank" href="{% url 'email_create' not_my_activity.pk %}" class="btn btn-outline-primary float-right mr-2 share_btn"><i class="far fa-envelope"></i></a> -->
        </p>
        {% endif %}
        {% endif %}
        <input class="selected" type="checkbox" style="display:none" id=activity_{{ not_my_activity.pk }} name ="checkboxes" value={{ not_my_activity.pk }} />
        <!-- <span style="color:green;" class="far fa-circle fa-3x float-right tickbox"></span> -->
        <!-- <span style="display:none;color:green;" class="far fa-check-circle fa-3x float-right tickboxSelected"></span> -->
    </div>
    <!-- <div class="card-footer"> -->
        <!-- {% if not_my_activity.bookmarked %}
        {% for bookmark_user in not_my_activity.bookmarked_users.all %}
        {% if bookmark_user.username == user.username %}
        <button onclick="markActivity(this.id)" id={{ not_my_activity.id }} type="button" class="btn js-bookmark-article active" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="far fa-bookmark"></i>
        </button>
        {% endif %}
        {% endfor %}
        {% endif %}
        <button onclick="markActivity(this.id)" id={{ not_my_activity.id }} type="button" class="btn js-bookmark-article remove" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="far fa-bookmark"></i>
        </button> -->
        <!-- <button onclick="getURL(this.id, this.value)" id="sharebutton_{{ not_my_activity.id }}" value="{% url 'activity_detail' not_my_activity.id %}" type="button" class="btn btn-primary mr-2" data-url="#" data-toggle="button" aria-pressed="false" autocomplete="off">
            <i class="fas fa-share"></i>
        </button>
    </div> -->
</div>
</div>
<!-- THE MODAL FOR SHARING URL -->
<div class="modal fade" id="modal_{{ not_my_activity.id }}">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
        <h4 class="modal-title">Share this activity</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="row justify-content-center mt-3">
            <div class="sharethis-inline-share-buttons" data-url="http://{{ domain }}{% url 'activity_detail' not_my_activity.id %}" 
            data-title="{{ not_my_activity.name }}" data-description="Test" data-message="test message" data-subject="test"></div>
            <a target="_self" class="btn btn-circle-2 ml-2" 
            href="sms:?&body=Check this out:%0D%0Ahttp://{{ domain }}{% url 'activity_detail' not_my_activity.pk %}"
            style="background:#ffc600;width:49px;height:49px;border-radius:100%;color:white;padding:0;">
            <img src="{% static 'img/icons/sms.png' %}" style="width:28px;margin-top:0px;margin-right:-2px;margin-bottom:1px;"></a>
            <a class="btn btn-circle-2 ml-2" href="mailto:?subject=Check%20this%20out!&body=Check this out:%0D%0Ahttp://{{ domain }}{% url 'activity_detail' not_my_activity.pk %}"
            style="background:grey;width:49px;height:49px;border-radius:100%;color:white;">
            <img src="{% static 'img/icons/envelope.png' %}" style="width:23px;margin-bottom:1px;"></a>
        </div>
        <div class="row mt-3 ml-3 mr-1">
        <input class="form-control text-center mr-2" type="text" id="textshow_{{ not_my_activity.id }}" value="http://{{ domain }}{% url 'activity_detail' not_my_activity.pk %}">
        <!-- <button class="btn btn-outline-success" type="button" onclick="copyURL(this.id)" id="cpbtn_{{ not_my_activity.id }}"><i class="far fa-copy"></i></button> -->
        </div>
        <div class="row ml-3 mt-1">
        <p class="small" id="input_{{ not_my_activity.id }}"></p>
        </div>
    </div>
    </div>
    </div>
{% endfor %}
</div>
</div>
{% endif %}
{% endif %}

{% endblock %}

{% block javascript %}
<script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5a2f1bb7fce9e20013a73372&product=inline-share-buttons"></script>
<!-- <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a435c987240088a"></script> -->
<!-- <script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5a7c1b21bd04be00137829e6&product=custom-share-buttons"></script> -->
<script src="{% static 'js/jquery.easy-autocomplete.js' %}"></script>
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<script src="{% static 'activities/js/bookmarks.js' %}"></script>
<script src="{% static 'js/swiper.js' %}"></script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDuR6-6PfCU7wRsSRRR3DH_PseEAYvyp3k&libraries=places&region=au"></script>

<script defer src="https://use.fontawesome.com/releases/v5.0.2/js/all.js"></script>
<script src="{% static 'js/jssocials.js' %}"></script>
<script>
var swiper = new Swiper('.swiper-container', {
    slidesPerView: 6,
    spaceBetween: 30,
    breakpoints: {
        1024: {
          slidesPerView: 6,
          spaceBetween: 40,
        },
        768: {
          slidesPerView: 3,
          spaceBetween: 30,
        },
        640: {
          slidesPerView: 3,
          spaceBetween: 15,
        },
        320: {
          slidesPerView: 1,
          spaceBetween: 10,
        }
    }
});

function markActivity(clicked_id) {
    var url_dest = '/activity/bookmark/'+clicked_id+'/'
    $.ajax({
        url: url_dest,
        type: 'get',
        dataType: 'json',
        beforeSend: function () {
        },
        success: function(){
            // alert(url_dest);
            $(this).toggleClass('active');
        }
    });
};

// window.fbAsyncInit = function() {
// FB.init({
//     appId            : '1943348669252986',
//     autoLogAppEvents : true,
//     xfbml            : true,
//     version          : 'v2.11'
// });
// };

(function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));

// function sendDialog(id) {
//     var url_arr = id.split("send_dialog_/");
//     var url = url_arr[1];
//     var url_final = window.location.href + url;

//     FB.ui({
//       method: 'send',
//       link: url_final
//     });
// }

function getURL(id, value) {
    var text_input_arr = id.split("sharebutton_");
    var activity_id = text_input_arr[1];

    var modal_id = "#modal_" + activity_id;
    var input_id = "#input_" + activity_id;

    $(input_id).html("");
    $(modal_id).modal("show");

    $(".st-btn").show();

    // var share = "#share_" + activity_id;
    // var share2 = "#share2_" + activity_id;
    // var share3 = "#share3_" + activity_id;
    // var share4 = "#share4_" + activity_id;
    // var share5 = "#share5_" + activity_id;

    // var url_val = value.substring(1);
    // var url_final = window.location.href + url_val;

    // $(share).jsSocials({
    //   shares: ["messenger"],
    //   showLabel: false,
    //   shareIn: "popup",
    //   url: url_final,
    // });
    // $(share2).jsSocials({
    //     shares: ["facebook"],
    //     showLabel: false,
    //     shareIn: "popup",
    //     url: url_final,
    // });
    // $(share3).jsSocials({
    //     shares: ["email"],
    //     showLabel: false,
    //     shareIn: "popup",
    //     url: url_final,
    // });
    // $(share4).jsSocials({
    //     shares: ["whatsapp"],
    //     showLabel: false,
    //     shareIn: "popup",
    //     url: url_final,
    // });
    // $(share5).jsSocials({
    //     shares: ["sms"],
    //     showLabel: false,
    //     shareIn: "popup",
    //     url: url_final,
    // });
}

function copyURL(id) {
    var msg_arr = id.split("cpbtn_");
    var activity_id = msg_arr[1];
    // alert(activity_id);

    var id_share_url = "textshow_" + activity_id;

    var copyText = document.getElementById(id_share_url);
    copyText.select();
    document.execCommand("Copy");

    var input_id = "#input_" + activity_id;

    $(input_id).html("Link has been copied!");
}

var shareBtns = document.getElementsByClassName("st-btn");

// shareBtns.forEach(function(element) {
    // element.style.display = inline-block;
    // console.log(element);
// });

// for (var i = 0; i < shareBtns.length; i++) {
//     console.log(shareBtns[i]);
// }

// Autocomplete on search location box
$( function() {
var options = {
    url :"/static/activities/json/suburbs-list.json",
    getValue: function (element) { 
        return $(element).prop("placeName") + ", " + $(element).prop("adminCode1") + " " + $(element).prop("postalcode");
    },
    list: {
        match: {
            enabled: true
        }
    }
};
$('#id_location').easyAutocomplete(options);

$('#main-share').click(function(){
    $('#share-text').toggle();
    $('#share-email').toggle();
});

$('#main-share-logged-in').click(function() {
    $('#share-twilio').toggle();
    $('#share-mailgun').toggle();
});

// Add Google Maps URL
//    var addressElements = document.getElementsByName("address");
//    var geocoder = new google.maps.Geocoder();

//    for (var i = 0; i < addressElements.length; i++) {
//        var address = $(addressElements[i]).text();
//        var map_url = "https://www.google.com/maps/search/?api=1&query=";
//        var full_url = map_url + address;
//        $(addressElements[i]).attr("href", full_url);
//    }

// function getSuburb(addressElement, address) {
//     var suburb = '';

//     geocoder.geocode({'address': address}, function(results, status) {
//     if (status === 'OK') {

//     var addressComponents = results[0].address_components;

//     console.log(addressComponents);

//     for (var k=0; k<addressComponents.length; k++) {
//         var types = addressComponents[k].types;
//         for (var j=0; j<types.length; j++) {
//             if (types[j] == "locality")  {
//                 suburb = addressComponents[k].long_name;
//                 addressElement.innerHTML = suburb.toUpperCase();
//                 addressElement.style.display = 'inline';
//                 break;
//             }
//         }
//         if (suburb != '') {
//             break;
//         }
//     }
//     } else {
//         console.log('Geocode was not successful for the following reason: ' + status);
//     }
//     return suburb;
//     });
// }

// for (var i = 0; i < addressElements.length; i++) {
//     var addressElement = addressElements[i];
//     var address = addressElement.innerHTML;
//     getSuburb(addressElement, address);
// }

   // Change apperance of bookmark button when clicked
    $( ".active" ).each(function() {
        $( this ).siblings('.remove').css( "display", "none" );
    });

    var messages = document.getElementsByClassName("published_message");

    for (i = 0; i < messages.length; i++) {
        if (messages[i].innerHTML == 'The activity has been published.') {
            $('#latest_activity').show();

            var id_latest = document.getElementById("latest_activity_val").getAttribute("class");
            var latest_activity_id = id_latest.split("latest_activity_")[1];

            var activities = document.getElementsByClassName("activity");

            for (i = 0; i < activities.length; i++) {
                var id = activities[i].getAttribute("id").split("activity_")[1];
                if (id == latest_activity_id ) {
                    activities[i].style.display = "none";
                    break;
                }
            }
        }
    }

   var isMobile = window.matchMedia("only screen and (max-width: 760px)");

    if (isMobile.matches) {
        $(".send_dialog").hide();
        // $("#yw_share_mobile").show();
        // $("#yw_share_desktop").hide();
    }
    else{
        $(".share").hide();
        $(".share4").hide();
        $(".share5").hide();
    }

  // Add Tooltips on search boxes
//   $('#id_location').tooltip();
//   $('#id_name').tooltip();

  var checkbox_arr = [];
  var activities_arr = [];

  // Dynamically display checkboxes
  $('.top').click( function() {
    $(this).children(".tickbox").toggle();
    $(this).children(".tickboxSelected").toggle();

    if ( $(this).children(".tickbox").css('display') == 'none' ) {
        $(this).css('background-color', 'rgba(192, 191, 191, 0.56)');
    } else {
        $(this).css('background-color', 'transparent');
    }

    //Change the background colour of card-body
    $(this).siblings(".card-body.select").toggleClass('on');

    var val = $(this).siblings(".card-body.select").attr('value');
    
    var activity_url;
    var ori_url = (window.location.href).toString();
    var web_url = (ori_url.substr(0, ori_url.indexOf('?')));
    var ori_url_2 = (ori_url.substr(0, ori_url.indexOf('#')));

    if (web_url != '') {
        activity_url = web_url + "activity/detail/";
    } else {
        if ( ori_url_2 != '' ){
            activity_url = ori_url_2 + "activity/detail/";
        } else {
            activity_url = ori_url + "activity/detail/";
        }
    }

    if ($(this).siblings(".card-body.select").hasClass('on')) {
        if (!checkbox_arr.includes(val)) {
            checkbox_arr.push(val);
            activities_arr.push(activity_url + val + "/");
        } else {
            if (checkbox_arr.includes(val)) {
            var index = checkbox_arr.indexOf(val);
            var index_activity = checkbox_arr.indexOf(activity_url + val + "/");
            checkbox_arr.splice(index, 1);
            activities_arr.splice(index_activity,1);
        }
        }
    } else {
        if (checkbox_arr.includes(val)) {
            var index = checkbox_arr.indexOf(val);
            var index_activity = checkbox_arr.indexOf(activity_url + val + "/");
            checkbox_arr.splice(index, 1);
            activities_arr.splice(index_activity,1);
        }
    }

    var href;
    var sms_url, email_url;
    var twilio_url, mailgun_url;
    var activity_url_final;

    // Codes for Mailgun/Twilio sharing
    if (checkbox_arr != []) {
        href = checkbox_arr.join('_');
    }

    // Codes for Mailgun/Twilio sharing
    if (href != '') {
        twilio_url = web_url + "sms_create/" + href + "/";
        mailgun_url = web_url + "email_create/" + href + "/";
    } else {
        twilio_url = "#";
        mailgun_url = "#";
    }

    activity_url_final = activities_arr.join('%0D%0A');

    if (activity_url_final != '') {
        email_url = "mailto:?subject=Check%20these%20out&body=Check these out:%0D%0A" + activity_url_final;
        sms_url = "sms:?&body=Check%20these%20out:%20" + activity_url_final;
    } else {
        email_url = "mailto:?subject=Check%20these%20out&body=Check these out:%0D%0A";
        sms_url = "sms:?&body=Check%20these%20out:%20";
    }
    
    // Free share button
    $("#share-text").attr("href", sms_url);
    $("#share-email").attr("href", email_url);

    // Mailgun / Twilio button
    $("#share-twilio").click(function() {
        window.open(twilio_url, 'newwindow', 'width=500,height=900');
    });

    $("#share-mailgun").click(function() {
        window.open(mailgun_url, 'newwindow', 'width=500,height=900');
    });

    // $("#share-twilio").attr("href", twilio_url);
    // $("#share-mailgun").attr("href", mailgun_url);
  });


  $('.card-body.select').click( function() {
      //Change the background colour of card-body
      $(this).toggleClass('on');
      var val = $(this).attr('value');
      var activity_url;
      var ori_url = (window.location.href).toString();
      var web_url = (ori_url.substr(0, ori_url.indexOf('?')));

    if (web_url != '') {
        activity_url = web_url + "activity/detail/";
    } else {
        activity_url = ori_url + "activity/detail/";
    }

      if ($(this).hasClass('on')) {
        if (!checkbox_arr.includes(val)) {
            checkbox_arr.push(val);
            activities_arr.push(activity_url + val + "/");
        }
      } else {
            if (checkbox_arr.includes(val)) {
                var index = checkbox_arr.indexOf(val);
                var index_activity = checkbox_arr.indexOf(activity_url + val + "/");
                checkbox_arr.splice(index, 1);
                activities_arr.splice(index_activity,1);
        }
      }

      var href;
      var sms_url, email_url;
      if (checkbox_arr != []) {
          href = checkbox_arr.join('_');
      }

      if (href != '') {
        sms_url = web_url + "sms_create/" + href + "/";
        // email_url = web_url + "email_create/" + href + "/";
      } else {
        sms_url = "#";
        // email_url = "#";
      }

    var activity_url_final = activities_arr.join('%0D%0A');

    if (activity_url_final != '') {
        email_url = "mailto:?subject=Check%20these%20out&body=Check these out:%0D%0A" + activity_url_final;
    } else {
        email_url = "mailto:?subject=Check%20these%20out&body=Check these out:%0D%0A";
    }
    //   $("#share-text").attr("href", sms_url);
    //   $("#share-email").attr("href", email_url);

      //change opacity of card-img-top
      $(this).siblings(".card-img-top.select").toggleClass('on');
      
//      card.children(".card-img-top").toggleClass('on');
      
      //show the checklist icon
    //   $(this).siblings(".selectedImg.select").toggle();
    //   $(this).children(".tickbox").toggle();
    //   $(this).children(".tickboxSelected").toggle();
    
    //   $(this).children(".card-text.small").children(".tickbox").toggle();
    //   $(this).children(".card-text.small").children(".tickboxSelected").toggle();
//      card.children(".selectedImg").toggle();
      
      //checked the checkbox element
      var checkbox = $(this).children(".selected");
      checkbox.prop("checked", !checkbox.prop("checked"));
      
      //alert($(this).parent(".selected").attr("class"));
  })
    
//   $('.card-img-top.select').click( function() {
//       //Change the background colour of card-body
//       $(this).siblings(".card-body.select").toggleClass('on');
      
//       //change opacity of card-img-top
//       $(this).toggleClass('on');
      
//       //show the checklist icon
//     //   $(this).siblings(".selectedImg.select").toggle();
      
//       //checked the checkbox element
//       var card_body = $(this).siblings(".card-body.select");
//       var checkbox = card_body.children(".selected");
//       checkbox.prop("checked", !checkbox.prop("checked"));
//   })

  var id_form = document.getElementById("id_form");
    $('#id_share_text').click(function(){
        id_form.setAttribute("target", "_blank");
    })
    $('#id_share_mobile').click(function(){
        id_form.setAttribute("target", "_blank");
    })
    $('.share_btn').click(function(){
        id_form.setAttribute("target", "_blank");
    })

});
</script>

{% endblock %} 